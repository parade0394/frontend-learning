<!doctype html>
<html data-theme="light" lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>å·¥å…·æç¤ºå®šä½ - DOM å…ƒç´ å°ºå¯¸å’Œä½ç½® API å®æˆ˜æ¡ˆä¾‹</title>
    <link href="../styles.css" rel="stylesheet" />
    <script type="module" src="/src/theme-sync.js"></script>
    <style>
      .tooltip-trigger {
        display: inline-block;
        padding: 10px 20px;
        background: var(--primary);
        color: white;
        border-radius: var(--radius-md);
        cursor: pointer;
        font-weight: 600;
        margin: 10px;
      }

      .tooltip {
        position: fixed;
        background: #1f2937;
        color: white;
        padding: 10px 16px;
        border-radius: 8px;
        font-size: 0.9rem;
        pointer-events: none;
        z-index: 1000;
        max-width: 250px;
        box-shadow: var(--shadow-lg);
        opacity: 0;
        transition: opacity 0.2s ease;
      }

      .tooltip.visible {
        opacity: 1;
      }

      .tooltip::after {
        content: '';
        position: absolute;
        border: 8px solid transparent;
      }

      .tooltip.top::after {
        bottom: -16px;
        left: 50%;
        transform: translateX(-50%);
        border-top-color: #1f2937;
      }

      .tooltip.bottom::after {
        top: -16px;
        left: 50%;
        transform: translateX(-50%);
        border-bottom-color: #1f2937;
      }
    </style>
  </head>
  <body>
    <aside class="sidebar">
      <div class="sidebar-header">
        <h1>DOM å…ƒç´ å°ºå¯¸å’Œä½ç½® API</h1>
        <a class="back-home" href="../index.html">â† è¿”å›ä¸»é¡µ</a>
      </div>
      <nav class="sidebar-nav">
        <div class="nav-section">
          <h3>å®æˆ˜åº”ç”¨</h3>
          <a class="nav-item" href="drag-drop.html">æ‹–æ‹½å…ƒç´ </a>
          <a class="nav-item" href="snap-align.html">å…ƒç´ å¸é™„å¯¹é½</a>
          <a class="nav-item active" href="tooltip.html">å·¥å…·æç¤ºå®šä½</a>
          <a class="nav-item" href="dropdown.html">ä¸‹æ‹‰èœå•å®šä½</a>
          <a class="nav-item" href="modal-center.html">æ¨¡æ€æ¡†å±…ä¸­</a>
          <a class="nav-item" href="scroll-progress.html">æ»šåŠ¨è¿›åº¦æ¡</a>
        </div>
      </nav>
    </aside>

    <main class="main-content">
      <div class="demo-page">
        <h1>å·¥å…·æç¤ºå®šä½</h1>
        <p class="subtitle">æ™ºèƒ½å®šä½å·¥å…·æç¤ºï¼Œé˜²æ­¢è¶…å‡ºè§†å£è¾¹ç•Œ</p>

        <section class="section">
          <h2>å®ç°åŸç†</h2>
          <p>
            ä½¿ç”¨ <code>getBoundingClientRect()</code> è·å–ç›®æ ‡å…ƒç´ å’Œè§†å£çš„ä½ç½®ä¿¡æ¯ï¼Œ
            åŠ¨æ€è®¡ç®—å·¥å…·æç¤ºçš„æœ€ä½³ä½ç½®ï¼Œé¿å…è¶…å‡ºè§†å£ã€‚
          </p>

          <pre
            class="code-block"
          ><code><span class="keyword">function</span> <span class="function">positionTooltip</span>(element, tooltip) {
  <span class="keyword">const</span> rect = element.<span class="function">getBoundingClientRect</span>();
  <span class="keyword">const</span> tooltipRect = tooltip.<span class="function">getBoundingClientRect</span>();

  <span class="comment">// é»˜è®¤æ˜¾ç¤ºåœ¨ä¸Šæ–¹</span>
  <span class="keyword">let</span> top = rect.top - tooltipRect.height - <span class="value">10</span>;
  <span class="keyword">let</span> left = rect.left + (rect.width - tooltipRect.width) / <span class="value">2</span>;

  <span class="comment">// æ£€æŸ¥æ˜¯å¦è¶…å‡ºé¡¶éƒ¨</span>
  <span class="keyword">if</span> (top &lt; <span class="value">0</span>) {
    <span class="comment">// æ”¹ä¸ºæ˜¾ç¤ºåœ¨ä¸‹æ–¹</span>
    top = rect.bottom + <span class="value">10</span>;
  }

  <span class="comment">// æ£€æŸ¥æ˜¯å¦è¶…å‡ºå·¦å³è¾¹ç•Œ</span>
  <span class="keyword">if</span> (left &lt; <span class="value">0</span>) {
    left = <span class="value">10</span>;
  } <span class="keyword">else if</span> (left + tooltipRect.width &gt; window.innerWidth) {
    left = window.innerWidth - tooltipRect.width - <span class="value">10</span>;
  }

  tooltip.style.top = top + <span class="string">'px'</span>;
  tooltip.style.left = left + <span class="string">'px'</span>;
}</code></pre>
        </section>

        <section class="section">
          <h2>ç¤ºä¾‹ï¼šæ™ºèƒ½å·¥å…·æç¤º</h2>
          <p>æ‚¬åœåœ¨æŒ‰é’®ä¸ŠæŸ¥çœ‹å·¥å…·æç¤ºï¼ˆä¼šè‡ªåŠ¨é¿å¼€è¾¹ç•Œï¼‰</p>

          <div class="demo-container" style="height: 300px">
            <div
              style="
                display: flex;
                gap: 20px;
                flex-wrap: wrap;
                justify-content: center;
                align-items: center;
                height: 100%;
              "
            >
              <button class="tooltip-trigger" data-tooltip="è¿™æ˜¯é¡¶éƒ¨æŒ‰é’®çš„å·¥å…·æç¤º">é¡¶éƒ¨æŒ‰é’®</button>
              <button class="tooltip-trigger" data-tooltip="è¿™æ˜¯ä¸­é—´æŒ‰é’®çš„å·¥å…·æç¤º">ä¸­é—´æŒ‰é’®</button>
              <button class="tooltip-trigger" data-tooltip="è¿™æ˜¯åº•éƒ¨æŒ‰é’®çš„å·¥å…·æç¤ºï¼Œä¼šè‡ªåŠ¨è°ƒæ•´ä½ç½®">åº•éƒ¨æŒ‰é’®</button>
            </div>

            <div id="tooltip" class="tooltip top"></div>
          </div>

          <div class="info-panel">
            <h4>æç¤ºæ¡†ä½ç½®</h4>
            <div class="info-row">
              <span class="info-label">ä½ç½®ç­–ç•¥:</span>
              <span id="tooltip-position" class="info-value">-</span>
            </div>
            <div class="info-row">
              <span class="info-label">Top:</span>
              <span id="tooltip-top" class="info-value">0px</span>
            </div>
            <div class="info-row">
              <span class="info-label">Left:</span>
              <span id="tooltip-left" class="info-value">0px</span>
            </div>
          </div>

          <div class="tip">
            <h4>ğŸ’¡ å…³é”®ç‚¹</h4>
            <p>
              å·¥å…·æç¤ºä¼šè‡ªåŠ¨é€‰æ‹©æœ€ä½³ä½ç½®ï¼š<br />
              1. ä¼˜å…ˆæ˜¾ç¤ºåœ¨ä¸Šæ–¹<br />
              2. å¦‚æœä¸Šæ–¹ç©ºé—´ä¸è¶³ï¼Œæ˜¾ç¤ºåœ¨ä¸‹æ–¹<br />
              3. é˜²æ­¢è¶…å‡ºå·¦å³è¾¹ç•Œ
            </p>
          </div>
        </section>

        <section class="section">
          <h2>æ€»ç»“</h2>
          <ul>
            <li>ä½¿ç”¨ getBoundingClientRect() è·å–å…ƒç´ ä½ç½®</li>
            <li>è®¡ç®—å·¥å…·æç¤ºçš„é»˜è®¤ä½ç½®</li>
            <li>æ£€æµ‹æ˜¯å¦ä¼šè¶…å‡ºè§†å£è¾¹ç•Œ</li>
            <li>åŠ¨æ€è°ƒæ•´ä½ç½®åˆ°åˆé€‚çš„æ–¹å‘</li>
            <li>ç¡®ä¿å·¥å…·æç¤ºå§‹ç»ˆå¯è§</li>
          </ul>
        </section>
      </div>
    </main>

    <script>
      const tooltip = document.getElementById('tooltip');
      const triggers = document.querySelectorAll('.tooltip-trigger');

      triggers.forEach((trigger) => {
        trigger.addEventListener('mouseenter', () => {
          const text = trigger.getAttribute('data-tooltip');
          tooltip.textContent = text;
          tooltip.classList.add('visible');

          positionTooltip(trigger, tooltip);
        });

        trigger.addEventListener('mouseleave', () => {
          tooltip.classList.remove('visible');
        });
      });

      function positionTooltip(element, tooltip) {
        const rect = element.getBoundingClientRect();
        const tooltipHeight = tooltip.offsetHeight || 40;
        const tooltipWidth = tooltip.offsetWidth || 200;

        // é»˜è®¤æ˜¾ç¤ºåœ¨ä¸Šæ–¹
        let top = rect.top - tooltipHeight - 10;
        let left = rect.left + (rect.width - tooltipWidth) / 2;
        let position = 'top';

        // æ£€æŸ¥æ˜¯å¦è¶…å‡ºé¡¶éƒ¨
        if (top < 0) {
          // æ”¹ä¸ºæ˜¾ç¤ºåœ¨ä¸‹æ–¹
          top = rect.bottom + 10;
          position = 'bottom';
          tooltip.className = 'tooltip visible bottom';
        } else {
          tooltip.className = 'tooltip visible top';
        }

        // æ£€æŸ¥æ˜¯å¦è¶…å‡ºå·¦å³è¾¹ç•Œ
        if (left < 10) {
          left = 10;
        } else if (left + tooltipWidth > window.innerWidth - 10) {
          left = window.innerWidth - tooltipWidth - 10;
        }

        tooltip.style.top = top + 'px';
        tooltip.style.left = left + 'px';

        document.getElementById('tooltip-position').textContent = position;
        document.getElementById('tooltip-top').textContent = Math.round(top) + 'px';
        document.getElementById('tooltip-left').textContent = Math.round(left) + 'px';
      }
    </script>
  </body>
</html>
