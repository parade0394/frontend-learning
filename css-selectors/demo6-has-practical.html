<!doctype html>
<html data-theme="light" lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>:has() å®æˆ˜ - CSS ç°ä»£é€‰æ‹©å™¨</title>
    <link href="/src/styles/common.css" rel="stylesheet" />
    <link href="styles.css" rel="stylesheet" />
    <script>
      (function () {
        try {
          const theme = localStorage.getItem('themeMode') || 'light';
          const color = localStorage.getItem('primaryColor') || '#10b981';
          let actualTheme = theme;
          if (theme === 'auto') {
            actualTheme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
          }
          document.documentElement.setAttribute('data-theme', actualTheme);
          document.documentElement.style.setProperty('--primary', color);
        } catch (e) {
          console.log(e);
        }
      })();
    </script>
    <script type="module" src="/src/theme.js"></script>
    <script src="compatibility-check.js"></script>
    <script src="accessibility-enhancements.js"></script>
  </head>
  <body data-demo="has-practical">
    <!-- Skip to main content link for accessibility -->
    <a class="skip-link" href="#main-content">è·³è½¬åˆ°ä¸»è¦å†…å®¹</a>
    <!-- å·¦ä¾§è¾¹æ å¯¼èˆª -->
    <aside class="sidebar" aria-label="æ¼”ç¤ºå¯¼èˆª" role="navigation">
      <div class="sidebar-header">
        <h1>CSS ç°ä»£é€‰æ‹©å™¨</h1>
        <a class="back-home" href="index.html" aria-label="è¿”å›ä¸»é¡µ">â† è¿”å›ä¸»é¡µ</a>
      </div>
      <nav class="sidebar-nav" aria-label="ä¸»å¯¼èˆª">
        <div class="nav-section">
          <h3>åŸºç¡€æ¦‚å¿µ</h3>
          <a class="nav-item" href="demo1-specificity.html">é€‰æ‹©å™¨ä¼˜å…ˆçº§</a>
        </div>
        <div class="nav-section">
          <h3>é€»è¾‘é€‰æ‹©å™¨</h3>
          <a class="nav-item" href="demo2-is.html">:is() ä¼ªç±»</a>
          <a class="nav-item" href="demo3-where.html">:where() ä¼ªç±»</a>
          <a class="nav-item" href="demo4-not.html">:not() ä¼ªç±»</a>
        </div>
        <div class="nav-section">
          <h3>çˆ¶å­å…³ç³»é€‰æ‹©å™¨</h3>
          <a class="nav-item" href="demo5-has-basics.html">:has() åŸºç¡€</a>
          <a class="nav-item active" href="demo6-has-practical.html">:has() å®æˆ˜</a>
        </div>
        <div class="nav-section">
          <h3>çŠ¶æ€é€‰æ‹©å™¨</h3>
          <a class="nav-item" href="demo7-focus-within.html">:focus-within</a>
          <a class="nav-item" href="demo8-focus-visible.html">:focus-visible</a>
        </div>
        <div class="nav-section">
          <h3>ç»“æ„é€‰æ‹©å™¨è¿›é˜¶</h3>
          <a class="nav-item" href="demo9-nth-child.html">:nth-child() é«˜çº§</a>
          <a class="nav-item" href="demo10-nth-comparison.html">ç»“æ„é€‰æ‹©å™¨å¯¹æ¯”</a>
        </div>
        <div class="nav-section">
          <h3>ç»¼åˆå®æˆ˜</h3>
          <a class="nav-item" href="demo11-combinations.html">é€‰æ‹©å™¨ç»„åˆå®æˆ˜</a>
        </div>
      </nav>
    </aside>

    <!-- å³ä¾§ä¸»å†…å®¹åŒº -->
    <main id="main-content" class="main-content" role="main">
      <div class="demo-page">
        <h1>:has() å®æˆ˜</h1>
        <p class="subtitle">çœŸå®é¡¹ç›®ä¸­çš„ :has() åº”ç”¨æ¡ˆä¾‹</p>

        <!-- æ¦‚å¿µä»‹ç» -->
        <section class="concept-section">
          <h2>å®æˆ˜åº”ç”¨åœºæ™¯</h2>
          <p>
            <code>:has()</code> ä¼ªç±»åœ¨å®é™…é¡¹ç›®ä¸­æœ‰ç€å¹¿æ³›çš„åº”ç”¨åœºæ™¯ã€‚
            é€šè¿‡æ ¹æ®å­å…ƒç´ çš„çŠ¶æ€æ¥æ”¹å˜çˆ¶å…ƒç´ çš„æ ·å¼ï¼Œæˆ‘ä»¬å¯ä»¥å®ç°è®¸å¤šä»¥å‰éœ€è¦ JavaScript æ‰èƒ½å®Œæˆçš„åŠŸèƒ½ã€‚
          </p>
          <p>
            æœ¬é¡µé¢å±•ç¤ºäº† 4 ä¸ªçœŸå®çš„åº”ç”¨æ¡ˆä¾‹ï¼Œæ¶µç›–äº†è¡¨å•éªŒè¯ã€å¡ç‰‡çŠ¶æ€ç®¡ç†ã€å¯¼èˆªèœå•å’Œè´­ç‰©è½¦ç­‰å¸¸è§åœºæ™¯ã€‚
            è¿™äº›æ¡ˆä¾‹éƒ½æ˜¯å¯ä»¥ç›´æ¥åº”ç”¨åˆ°å®é™…é¡¹ç›®ä¸­çš„å®ç”¨æŠ€å·§ã€‚
          </p>
          <ul>
            <li><strong>è¡¨å•éªŒè¯</strong> - æ ¹æ®è¾“å…¥æ¡†çŠ¶æ€æ”¹å˜è¡¨å•å®¹å™¨æ ·å¼</li>
            <li><strong>å¡ç‰‡çŠ¶æ€</strong> - æ ¹æ®å†…å®¹å’Œé€‰ä¸­çŠ¶æ€è°ƒæ•´å¡ç‰‡å¸ƒå±€</li>
            <li><strong>å¯¼èˆªèœå•</strong> - æ™ºèƒ½é«˜äº®å’Œå­èœå•æŒ‡ç¤º</li>
            <li><strong>è´­ç‰©è½¦</strong> - æ ¹æ®å•†å“æ•°é‡æ˜¾ç¤ºä¸åŒçŠ¶æ€</li>
          </ul>
        </section>

        <!-- æ¡ˆä¾‹ 1: è¡¨å•éªŒè¯çŠ¶æ€ -->
        <section class="demo-section">
          <h2>æ¡ˆä¾‹ 1: è¡¨å•éªŒè¯çŠ¶æ€</h2>
          <p style="color: var(--text-secondary); margin-bottom: 20px">
            ä½¿ç”¨ <code>:has()</code> æ ¹æ®è¡¨å•å†…è¾“å…¥æ¡†çš„éªŒè¯çŠ¶æ€ï¼ŒåŠ¨æ€æ”¹å˜è¡¨å•å®¹å™¨çš„æ ·å¼ï¼Œæä¾›å®æ—¶çš„è§†è§‰åé¦ˆã€‚
          </p>

          <div class="demo-container single-column">
            <div class="demo-preview">
              <div class="demo-preview-title">æ•ˆæœé¢„è§ˆ - å°è¯•å¡«å†™è¡¨å•</div>
              <style>
                .form-validation-demo {
                  max-width: 600px;
                  margin: 0 auto;
                }

                .validation-form {
                  background: var(--bg-primary);
                  border: 3px solid var(--border-color);
                  border-radius: 12px;
                  padding: 30px;
                  transition: all 0.3s ease;
                }

                /* è¡¨å•åŒ…å«æ— æ•ˆè¾“å…¥æ—¶æ˜¾ç¤ºé”™è¯¯æ ·å¼ */
                .validation-form:has(input:invalid) {
                  border-color: var(--error);
                  background: var(--error-light);
                }

                /* è¡¨å•å…¨éƒ¨æœ‰æ•ˆæ—¶æ˜¾ç¤ºæˆåŠŸæ ·å¼ */
                .validation-form:has(input:valid):not(:has(input:placeholder-shown)) {
                  border-color: var(--success);
                  background: var(--success-light);
                }

                .validation-form h3 {
                  margin-top: 0;
                  color: var(--text-primary);
                  font-size: 1.3rem;
                }

                .form-status {
                  padding: 12px 16px;
                  border-radius: 8px;
                  margin-bottom: 20px;
                  font-weight: 600;
                  display: none;
                }

                /* æ˜¾ç¤ºé”™è¯¯çŠ¶æ€ */
                .validation-form:has(input:invalid) .form-status.error {
                  display: block;
                  background: var(--error);
                  color: white;
                }

                /* æ˜¾ç¤ºæˆåŠŸçŠ¶æ€ */
                .validation-form:has(input:valid):not(:has(input:placeholder-shown)) .form-status.success {
                  display: block;
                  background: var(--success);
                  color: white;
                }

                .form-group {
                  margin-bottom: 20px;
                }

                .form-group label {
                  display: block;
                  margin-bottom: 8px;
                  font-weight: 600;
                  color: var(--text-primary);
                }

                .form-group input {
                  width: 100%;
                  padding: 12px 15px;
                  border: 2px solid var(--border-color);
                  border-radius: 8px;
                  font-size: 1rem;
                  background: var(--bg-secondary);
                  color: var(--text-primary);
                  box-sizing: border-box;
                  transition: all 0.3s;
                }

                .form-group input:focus {
                  outline: none;
                  border-color: var(--primary);
                  box-shadow: 0 0 0 3px var(--primary-light);
                }

                .form-group input:invalid {
                  border-color: var(--error);
                }

                .form-group input:valid:not(:placeholder-shown) {
                  border-color: var(--success);
                }

                .submit-btn {
                  width: 100%;
                  padding: 14px;
                  background: var(--primary);
                  color: white;
                  border: none;
                  border-radius: 8px;
                  font-size: 1.1rem;
                  font-weight: 600;
                  cursor: pointer;
                  transition: all 0.3s;
                }

                .submit-btn:hover {
                  background: var(--primary-dark);
                  transform: translateY(-2px);
                  box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
                }
              </style>

              <div class="form-validation-demo">
                <form class="validation-form" aria-label="ç”¨æˆ·æ³¨å†Œè¡¨å•">
                  <h3>ç”¨æˆ·æ³¨å†Œ</h3>

                  <div class="form-status error" aria-live="assertive" role="alert">âš ï¸ è¯·æ£€æŸ¥è¡¨å•è¾“å…¥</div>
                  <div class="form-status success" aria-live="polite" role="status">âœ“ è¡¨å•å¡«å†™å®Œæ•´ï¼Œå¯ä»¥æäº¤</div>

                  <div class="form-group">
                    <label for="username">ç”¨æˆ·åï¼ˆè‡³å°‘ 3 ä¸ªå­—ç¬¦ï¼‰</label>
                    <input
                      id="username"
                      type="text"
                      placeholder="è¯·è¾“å…¥ç”¨æˆ·å"
                      required
                      aria-required="true"
                      aria-describedby="username-help"
                      minlength="3"
                    />
                    <span id="username-help" class="sr-only">ç”¨æˆ·åå¿…é¡»è‡³å°‘åŒ…å« 3 ä¸ªå­—ç¬¦</span>
                  </div>

                  <div class="form-group">
                    <label for="email">é‚®ç®±</label>
                    <input
                      id="email"
                      type="email"
                      placeholder="è¯·è¾“å…¥é‚®ç®±"
                      required
                      aria-required="true"
                      aria-describedby="email-help"
                    />
                    <span id="email-help" class="sr-only">è¯·è¾“å…¥æœ‰æ•ˆçš„ç”µå­é‚®ç®±åœ°å€</span>
                  </div>

                  <div class="form-group">
                    <label for="password">å¯†ç ï¼ˆè‡³å°‘ 6 ä¸ªå­—ç¬¦ï¼‰</label>
                    <input
                      id="password"
                      type="password"
                      placeholder="è¯·è¾“å…¥å¯†ç "
                      required
                      aria-required="true"
                      aria-describedby="password-help"
                      minlength="6"
                    />
                    <span id="password-help" class="sr-only">å¯†ç å¿…é¡»è‡³å°‘åŒ…å« 6 ä¸ªå­—ç¬¦</span>
                  </div>

                  <button class="submit-btn" type="submit" aria-label="æäº¤æ³¨å†Œè¡¨å•">æäº¤æ³¨å†Œ</button>
                </form>
              </div>

              <p style="margin-top: 20px; color: var(--text-secondary); font-size: 0.9rem">
                ğŸ’¡ å°è¯•å¡«å†™è¡¨å•ï¼Œè§‚å¯Ÿè¡¨å•å®¹å™¨çš„è¾¹æ¡†å’ŒèƒŒæ™¯è‰²å˜åŒ–
              </p>
            </div>

            <div class="demo-code">
              <pre><code><span class="code-comment">/* è¡¨å•åŒ…å«æ— æ•ˆè¾“å…¥æ—¶æ˜¾ç¤ºé”™è¯¯æ ·å¼ */</span>
.validation-form:has(input:invalid) {
  border-color: red;
  background: #fee;
}

<span class="code-comment">/* æ˜¾ç¤ºé”™è¯¯æç¤º */</span>
.validation-form:has(input:invalid) .form-status.error {
  display: block;
}

<span class="code-comment">/* è¡¨å•å…¨éƒ¨æœ‰æ•ˆæ—¶æ˜¾ç¤ºæˆåŠŸæ ·å¼ */</span>
.validation-form:has(input:valid):not(:has(input:placeholder-shown)) {
  border-color: green;
  background: #efe;
}

<span class="code-comment">/* æ˜¾ç¤ºæˆåŠŸæç¤º */</span>
.validation-form:has(input:valid):not(:has(input:placeholder-shown)) .form-status.success {
  display: block;
}

<span class="code-comment">/* ä¼˜åŠ¿ï¼šæ— éœ€ JavaScript å³å¯å®ç°å®æ—¶éªŒè¯åé¦ˆ */</span></code></pre>
            </div>
          </div>
        </section>

        <!-- æ¡ˆä¾‹ 2: å¡ç‰‡çŠ¶æ€ç®¡ç† -->
        <section class="demo-section">
          <h2>æ¡ˆä¾‹ 2: å¡ç‰‡çŠ¶æ€ç®¡ç†</h2>
          <p style="color: var(--text-secondary); margin-bottom: 20px">
            æ ¹æ®å¡ç‰‡å†…å®¹å’Œé€‰ä¸­çŠ¶æ€ï¼ŒåŠ¨æ€è°ƒæ•´å¡ç‰‡çš„æ ·å¼å’Œå¸ƒå±€ã€‚è¿™åœ¨ä»»åŠ¡åˆ—è¡¨ã€å•†å“åˆ—è¡¨ç­‰åœºæ™¯ä¸­éå¸¸å®ç”¨ã€‚
          </p>

          <div class="demo-container single-column">
            <div class="demo-preview">
              <div class="demo-preview-title">æ•ˆæœé¢„è§ˆ - ç‚¹å‡»å¤é€‰æ¡†æŸ¥çœ‹æ•ˆæœ</div>
              <style>
                .card-demo {
                  display: grid;
                  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
                  gap: 20px;
                }

                .product-card {
                  background: var(--bg-primary);
                  border: 2px solid var(--border-color);
                  border-radius: 12px;
                  padding: 20px;
                  transition: all 0.3s ease;
                  position: relative;
                }

                /* å¡ç‰‡åŒ…å«é€‰ä¸­å¤é€‰æ¡†æ—¶é«˜äº® */
                .product-card:has(input[type='checkbox']:checked) {
                  background: var(--primary-light);
                  border-color: var(--primary);
                  box-shadow: 0 4px 12px rgba(16, 185, 129, 0.2);
                  transform: scale(1.02);
                }

                /* å¡ç‰‡åŒ…å«å›¾ç‰‡æ—¶è°ƒæ•´å¸ƒå±€ */
                .product-card:has(img) {
                  display: grid;
                  grid-template-rows: auto 1fr auto;
                  gap: 15px;
                }

                .product-card:has(img) .card-content {
                  display: flex;
                  flex-direction: column;
                  gap: 10px;
                }

                .card-checkbox {
                  position: absolute;
                  top: 15px;
                  right: 15px;
                  width: 24px;
                  height: 24px;
                  cursor: pointer;
                }

                .card-image {
                  width: 100%;
                  height: 150px;
                  background: var(--bg-secondary);
                  border-radius: 8px;
                  display: flex;
                  align-items: center;
                  justify-content: center;
                  font-size: 3rem;
                }

                .card-title {
                  font-size: 1.2rem;
                  font-weight: 700;
                  color: var(--text-primary);
                  margin: 0;
                }

                .card-description {
                  color: var(--text-secondary);
                  font-size: 0.9rem;
                  line-height: 1.5;
                  margin: 0;
                }

                .card-price {
                  font-size: 1.3rem;
                  font-weight: 700;
                  color: var(--primary);
                  margin: 10px 0 0;
                }

                /* é€‰ä¸­çŠ¶æ€çš„ç‰¹æ®Šæ ·å¼ */
                .product-card:has(input:checked) .card-title {
                  color: var(--primary);
                }

                .product-card:has(input:checked)::before {
                  content: 'âœ“ å·²é€‰ä¸­';
                  position: absolute;
                  top: 15px;
                  left: 15px;
                  background: var(--primary);
                  color: white;
                  padding: 4px 12px;
                  border-radius: 20px;
                  font-size: 0.8rem;
                  font-weight: 600;
                }
              </style>

              <div class="card-demo" aria-label="äº§å“åˆ—è¡¨" role="group">
                <div class="product-card">
                  <input id="product-1" class="card-checkbox" type="checkbox" aria-label="é€‰æ‹©æ™ºèƒ½æ‰‹æœº" />
                  <div class="card-image" aria-hidden="true">ğŸ“±</div>
                  <div class="card-content">
                    <h4 class="card-title">æ™ºèƒ½æ‰‹æœº</h4>
                    <p class="card-description">æœ€æ–°æ¬¾æ——èˆ°æ‰‹æœºï¼Œæ€§èƒ½å¼ºåŠ²</p>
                    <p class="card-price">Â¥4,999</p>
                  </div>
                </div>

                <div class="product-card">
                  <input id="product-2" class="card-checkbox" type="checkbox" aria-label="é€‰æ‹©æ— çº¿è€³æœº" />
                  <div class="card-content">
                    <h4 class="card-title">æ— çº¿è€³æœº</h4>
                    <p class="card-description">é™å™ªè€³æœºï¼ŒéŸ³è´¨å‡ºè‰²ï¼ˆæ— å›¾ç‰‡ï¼‰</p>
                    <p class="card-price">Â¥1,299</p>
                  </div>
                </div>

                <div class="product-card">
                  <input id="product-3" class="card-checkbox" type="checkbox" aria-label="é€‰æ‹©ç¬”è®°æœ¬ç”µè„‘" />
                  <div class="card-image" aria-hidden="true">ğŸ’»</div>
                  <div class="card-content">
                    <h4 class="card-title">ç¬”è®°æœ¬ç”µè„‘</h4>
                    <p class="card-description">è½»è–„ä¾¿æºï¼Œé€‚åˆåŠå…¬</p>
                    <p class="card-price">Â¥6,999</p>
                  </div>
                </div>

                <div class="product-card">
                  <input id="product-4" class="card-checkbox" type="checkbox" aria-label="é€‰æ‹©æ™ºèƒ½æ‰‹è¡¨" />
                  <div class="card-content">
                    <h4 class="card-title">æ™ºèƒ½æ‰‹è¡¨</h4>
                    <p class="card-description">å¥åº·ç›‘æµ‹ï¼Œè¿åŠ¨è¿½è¸ªï¼ˆæ— å›¾ç‰‡ï¼‰</p>
                    <p class="card-price">Â¥2,499</p>
                  </div>
                </div>
              </div>

              <p style="margin-top: 20px; color: var(--text-secondary); font-size: 0.9rem">
                ğŸ’¡ ç‚¹å‡»å¡ç‰‡å³ä¸Šè§’çš„å¤é€‰æ¡†ï¼Œè§‚å¯Ÿå¡ç‰‡æ ·å¼å˜åŒ–ã€‚æœ‰å›¾ç‰‡çš„å¡ç‰‡å¸ƒå±€ä¹Ÿä¸åŒã€‚
              </p>
            </div>

            <div class="demo-code">
              <pre><code><span class="code-comment">/* å¡ç‰‡åŒ…å«é€‰ä¸­å¤é€‰æ¡†æ—¶é«˜äº® */</span>
.product-card:has(input[type="checkbox"]:checked) {
  background: lightgreen;
  border-color: green;
  box-shadow: 0 4px 12px rgba(0, 255, 0, 0.2);
  transform: scale(1.02);
}

<span class="code-comment">/* æ˜¾ç¤ºé€‰ä¸­æ ‡ç­¾ */</span>
.product-card:has(input:checked)::before {
  content: 'âœ“ å·²é€‰ä¸­';
  position: absolute;
  top: 15px;
  left: 15px;
  background: green;
  color: white;
  padding: 4px 12px;
  border-radius: 20px;
}

<span class="code-comment">/* å¡ç‰‡åŒ…å«å›¾ç‰‡æ—¶è°ƒæ•´å¸ƒå±€ */</span>
.product-card:has(img) {
  display: grid;
  grid-template-rows: auto 1fr auto;
  gap: 15px;
}

<span class="code-comment">/* å¤šç§çŠ¶æ€ç»„åˆï¼šæ ¹æ®å†…å®¹å’Œé€‰ä¸­çŠ¶æ€åŠ¨æ€è°ƒæ•´ */</span></code></pre>
            </div>
          </div>
        </section>

        <!-- æ¡ˆä¾‹ 3: å¯¼èˆªèœå•é«˜äº® -->
        <section class="demo-section">
          <h2>æ¡ˆä¾‹ 3: å¯¼èˆªèœå•é«˜äº®</h2>
          <p style="color: var(--text-secondary); margin-bottom: 20px">
            ä½¿ç”¨ <code>:has()</code> å®ç°æ™ºèƒ½å¯¼èˆªèœå•ï¼Œæ ¹æ®å½“å‰é¡µé¢é“¾æ¥è‡ªåŠ¨é«˜äº®çˆ¶çº§å¯¼èˆªé¡¹ï¼Œå¹¶ä¸ºåŒ…å«å­èœå•çš„é¡¹æ˜¾ç¤ºç®­å¤´ã€‚
          </p>

          <div class="demo-container single-column">
            <div class="demo-preview">
              <div class="demo-preview-title">æ•ˆæœé¢„è§ˆ - ç‚¹å‡»é“¾æ¥æŸ¥çœ‹æ•ˆæœ</div>
              <style>
                .nav-demo {
                  background: var(--bg-secondary);
                  padding: 20px;
                  border-radius: 12px;
                }

                .smart-nav {
                  list-style: none;
                  padding: 0;
                  margin: 0;
                }

                .smart-nav > li {
                  margin-bottom: 8px;
                }

                .smart-nav a {
                  display: block;
                  padding: 12px 16px;
                  color: var(--text-primary);
                  text-decoration: none;
                  border-radius: 8px;
                  font-weight: 600;
                  transition: all 0.3s;
                  background: var(--bg-primary);
                }

                .smart-nav a:hover {
                  background: var(--primary-light);
                  color: var(--primary);
                  transform: translateX(4px);
                }

                .smart-nav a.active {
                  background: var(--primary);
                  color: white;
                }

                /* åŒ…å«å½“å‰é¡µé¢é“¾æ¥çš„å¯¼èˆªé¡¹é«˜äº® */
                .smart-nav li:has(a.active) {
                  background: var(--primary-light);
                  border-radius: 8px;
                  padding: 8px;
                }

                /* åŒ…å«å­èœå•çš„å¯¼èˆªé¡¹æ˜¾ç¤ºç®­å¤´ */
                .smart-nav li:has(ul) > a::after {
                  content: 'â–¼';
                  float: right;
                  font-size: 0.8rem;
                  transition: transform 0.3s;
                }

                /* å­èœå•æ ·å¼ */
                .smart-nav ul {
                  list-style: none;
                  padding: 8px 0 0 20px;
                  margin: 8px 0 0;
                  border-left: 2px solid var(--primary);
                }

                .smart-nav ul li {
                  margin-bottom: 4px;
                }

                .smart-nav ul a {
                  padding: 8px 12px;
                  font-size: 0.9rem;
                  font-weight: 500;
                }

                /* å±•å¼€/æ”¶èµ·çŠ¶æ€ç®¡ç† */
                .smart-nav li:has(ul) {
                  position: relative;
                }

                .smart-nav li:has(ul) ul {
                  max-height: 0;
                  overflow: hidden;
                  transition: max-height 0.3s ease;
                }

                .smart-nav li:has(ul):hover ul,
                .smart-nav li:has(a.active) ul {
                  max-height: 500px;
                }

                .smart-nav li:has(ul):hover > a::after,
                .smart-nav li:has(a.active) > a::after {
                  transform: rotate(180deg);
                }
              </style>

              <div class="nav-demo">
                <ul class="smart-nav">
                  <li>
                    <a href="#home">é¦–é¡µ</a>
                  </li>
                  <li>
                    <a href="#products">äº§å“ä¸­å¿ƒ</a>
                    <ul>
                      <li><a href="#product-1">äº§å“ A</a></li>
                      <li><a class="active" href="#product-2">äº§å“ Bï¼ˆå½“å‰é¡µï¼‰</a></li>
                      <li><a href="#product-3">äº§å“ C</a></li>
                    </ul>
                  </li>
                  <li>
                    <a href="#services">æœåŠ¡æ”¯æŒ</a>
                    <ul>
                      <li><a href="#service-1">æŠ€æœ¯æ”¯æŒ</a></li>
                      <li><a href="#service-2">å”®åæœåŠ¡</a></li>
                    </ul>
                  </li>
                  <li>
                    <a href="#about">å…³äºæˆ‘ä»¬</a>
                  </li>
                  <li>
                    <a href="#contact">è”ç³»æ–¹å¼</a>
                  </li>
                </ul>
              </div>

              <p style="margin-top: 20px; color: var(--text-secondary); font-size: 0.9rem">
                ğŸ’¡ "äº§å“ä¸­å¿ƒ"åŒ…å«å½“å‰æ¿€æ´»çš„å­é“¾æ¥ï¼Œå› æ­¤è‡ªåŠ¨é«˜äº®å¹¶å±•å¼€ã€‚æœ‰å­èœå•çš„é¡¹æ˜¾ç¤ºç®­å¤´ã€‚
              </p>
            </div>

            <div class="demo-code">
              <pre><code><span class="code-comment">/* åŒ…å«å½“å‰é¡µé¢é“¾æ¥çš„å¯¼èˆªé¡¹é«˜äº® */</span>
.smart-nav li:has(a.active) {
  background: lightgreen;
  border-radius: 8px;
  padding: 8px;
}

<span class="code-comment">/* åŒ…å«å­èœå•çš„å¯¼èˆªé¡¹æ˜¾ç¤ºç®­å¤´ */</span>
.smart-nav li:has(ul) > a::after {
  content: 'â–¼';
  float: right;
  transition: transform 0.3s;
}

<span class="code-comment">/* å±•å¼€åŒ…å«æ¿€æ´»é“¾æ¥çš„å­èœå• */</span>
.smart-nav li:has(a.active) ul {
  max-height: 500px;
}

<span class="code-comment">/* æ—‹è½¬ç®­å¤´ */</span>
.smart-nav li:has(a.active) > a::after {
  transform: rotate(180deg);
}

<span class="code-comment">/* ä¼˜åŠ¿ï¼šçˆ¶çº§å¯¼èˆªè‡ªåŠ¨æ„ŸçŸ¥å­é“¾æ¥çŠ¶æ€ï¼Œæ— éœ€æ‰‹åŠ¨æ·»åŠ ç±» */</span></code></pre>
            </div>
          </div>
        </section>

        <!-- æ¡ˆä¾‹ 4: è´­ç‰©è½¦çŠ¶æ€ -->
        <section class="demo-section">
          <h2>æ¡ˆä¾‹ 4: è´­ç‰©è½¦çŠ¶æ€</h2>
          <p style="color: var(--text-secondary); margin-bottom: 20px">
            æ ¹æ®è´­ç‰©è½¦ä¸­æ˜¯å¦æœ‰å•†å“ï¼ŒåŠ¨æ€æ˜¾ç¤ºä¸åŒçš„çŠ¶æ€å’Œæ“ä½œæŒ‰é’®ã€‚è¿™æ˜¯ç”µå•†ç½‘ç«™ä¸­éå¸¸å¸¸è§çš„åœºæ™¯ã€‚
          </p>

          <div class="demo-container single-column">
            <div class="demo-preview">
              <div class="demo-preview-title">æ•ˆæœé¢„è§ˆ - ç‚¹å‡»æŒ‰é’®æ·»åŠ /ç§»é™¤å•†å“</div>
              <style>
                .cart-demo {
                  max-width: 600px;
                  margin: 0 auto;
                }

                .shopping-cart {
                  background: var(--bg-primary);
                  border: 2px solid var(--border-color);
                  border-radius: 12px;
                  padding: 25px;
                  min-height: 300px;
                  position: relative;
                }

                .cart-header {
                  display: flex;
                  justify-content: space-between;
                  align-items: center;
                  margin-bottom: 20px;
                  padding-bottom: 15px;
                  border-bottom: 2px solid var(--border-color);
                }

                .cart-header h3 {
                  margin: 0;
                  color: var(--text-primary);
                  font-size: 1.4rem;
                }

                .cart-count {
                  background: var(--primary);
                  color: white;
                  padding: 4px 12px;
                  border-radius: 20px;
                  font-weight: 600;
                  font-size: 0.9rem;
                }

                .cart-items {
                  margin-bottom: 20px;
                }

                .cart-item {
                  display: flex;
                  justify-content: space-between;
                  align-items: center;
                  padding: 15px;
                  background: var(--bg-secondary);
                  border-radius: 8px;
                  margin-bottom: 10px;
                }

                .item-info {
                  flex: 1;
                }

                .item-name {
                  font-weight: 600;
                  color: var(--text-primary);
                  margin-bottom: 5px;
                }

                .item-price {
                  color: var(--primary);
                  font-weight: 700;
                }

                .remove-btn {
                  padding: 6px 12px;
                  background: var(--error);
                  color: white;
                  border: none;
                  border-radius: 6px;
                  cursor: pointer;
                  font-size: 0.85rem;
                  font-weight: 600;
                  transition: all 0.3s;
                }

                .remove-btn:hover {
                  background: var(--error-dark);
                  transform: scale(1.05);
                }

                /* è´­ç‰©è½¦ä¸ºç©ºæ—¶æ˜¾ç¤ºæç¤º */
                .empty-message {
                  display: none;
                  text-align: center;
                  padding: 60px 20px;
                  color: var(--text-secondary);
                }

                .shopping-cart:not(:has(.cart-item)) .empty-message {
                  display: block;
                }

                .empty-message .icon {
                  font-size: 4rem;
                  margin-bottom: 15px;
                  opacity: 0.5;
                }

                .empty-message h4 {
                  margin: 0 0 10px;
                  color: var(--text-primary);
                  font-size: 1.2rem;
                }

                /* è´­ç‰©è½¦æœ‰å•†å“æ—¶æ˜¾ç¤ºç»“ç®—æŒ‰é’® */
                .cart-actions {
                  display: none;
                  gap: 10px;
                }

                .shopping-cart:has(.cart-item) .cart-actions {
                  display: flex;
                }

                .checkout-btn {
                  flex: 1;
                  padding: 14px;
                  background: var(--primary);
                  color: white;
                  border: none;
                  border-radius: 8px;
                  font-size: 1.1rem;
                  font-weight: 600;
                  cursor: pointer;
                  transition: all 0.3s;
                }

                .checkout-btn:hover {
                  background: var(--primary-dark);
                  transform: translateY(-2px);
                  box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
                }

                .clear-btn {
                  padding: 14px 24px;
                  background: var(--bg-secondary);
                  color: var(--text-primary);
                  border: 2px solid var(--border-color);
                  border-radius: 8px;
                  font-size: 1rem;
                  font-weight: 600;
                  cursor: pointer;
                  transition: all 0.3s;
                }

                .clear-btn:hover {
                  border-color: var(--error);
                  color: var(--error);
                }

                /* éšè—è´­ç‰©è½¦ä¸ºç©ºæ—¶çš„å•†å“åˆ—è¡¨å®¹å™¨ */
                .shopping-cart:not(:has(.cart-item)) .cart-items {
                  display: none;
                }

                /* éšè—è´­ç‰©è½¦ä¸ºç©ºæ—¶çš„æ•°é‡æ ‡ç­¾ */
                .shopping-cart:not(:has(.cart-item)) .cart-count {
                  display: none;
                }

                .add-demo-items {
                  margin-top: 20px;
                  padding: 15px;
                  background: var(--bg-secondary);
                  border-radius: 8px;
                  text-align: center;
                }

                .add-item-btn {
                  padding: 10px 20px;
                  background: var(--primary);
                  color: white;
                  border: none;
                  border-radius: 6px;
                  font-weight: 600;
                  cursor: pointer;
                  transition: all 0.3s;
                  margin: 5px;
                }

                .add-item-btn:hover {
                  background: var(--primary-dark);
                  transform: translateY(-2px);
                }
              </style>

              <div class="cart-demo">
                <div id="shoppingCart" class="shopping-cart" aria-label="è´­ç‰©è½¦" role="region">
                  <div class="cart-header">
                    <h3>è´­ç‰©è½¦</h3>
                    <span id="cartCount" class="cart-count" aria-live="polite" role="status">0 ä»¶å•†å“</span>
                  </div>

                  <div class="empty-message" aria-live="polite" role="status">
                    <div class="icon" aria-hidden="true">ğŸ›’</div>
                    <h4>è´­ç‰©è½¦æ˜¯ç©ºçš„</h4>
                    <p>å¿«å»æ·»åŠ ä¸€äº›å•†å“å§ï¼</p>
                  </div>

                  <div id="cartItems" class="cart-items" aria-label="è´­ç‰©è½¦å•†å“åˆ—è¡¨" role="list">
                    <!-- å•†å“å°†é€šè¿‡ JavaScript åŠ¨æ€æ·»åŠ  -->
                  </div>

                  <div class="cart-actions">
                    <button class="checkout-btn" aria-label="å‰å¾€ç»“ç®—é¡µé¢">å»ç»“ç®—</button>
                    <button class="clear-btn" aria-label="æ¸…ç©ºè´­ç‰©è½¦ä¸­çš„æ‰€æœ‰å•†å“" onclick="clearCart()">
                      æ¸…ç©ºè´­ç‰©è½¦
                    </button>
                  </div>
                </div>

                <div class="add-demo-items" aria-label="æ·»åŠ å•†å“åˆ°è´­ç‰©è½¦" role="group">
                  <p style="margin-top: 0; color: var(--text-secondary); font-weight: 600">
                    æµ‹è¯•åŠŸèƒ½ï¼šæ·»åŠ å•†å“åˆ°è´­ç‰©è½¦
                  </p>
                  <button class="add-item-btn" aria-label="æ·»åŠ æ™ºèƒ½æ‰‹æœºåˆ°è´­ç‰©è½¦" onclick="addItem('æ™ºèƒ½æ‰‹æœº', 4999)">
                    æ·»åŠ æ‰‹æœº
                  </button>
                  <button class="add-item-btn" aria-label="æ·»åŠ æ— çº¿è€³æœºåˆ°è´­ç‰©è½¦" onclick="addItem('æ— çº¿è€³æœº', 1299)">
                    æ·»åŠ è€³æœº
                  </button>
                  <button
                    class="add-item-btn"
                    aria-label="æ·»åŠ ç¬”è®°æœ¬ç”µè„‘åˆ°è´­ç‰©è½¦"
                    onclick="addItem('ç¬”è®°æœ¬ç”µè„‘', 6999)"
                  >
                    æ·»åŠ ç”µè„‘
                  </button>
                </div>
              </div>

              <script>
                window.addItem = function addItem(name, price) {
                  const cartItems = document.getElementById('cartItems');
                  const item = document.createElement('div');
                  item.className = 'cart-item';
                  item.setAttribute('role', 'listitem');
                  item.innerHTML = `
                    <div class="item-info">
                      <div class="item-name">${name}</div>
                      <div class="item-price">Â¥${price}</div>
                    </div>
                    <button class="remove-btn" onclick="removeItem(this)" aria-label="ä»è´­ç‰©è½¦ç§»é™¤ ${name}">ç§»é™¤</button>
                  `;
                  cartItems.appendChild(item);
                  updateCartCount();

                  // Announce to screen reader
                  if (window.announceToScreenReader) {
                    window.announceToScreenReader(`å·²æ·»åŠ  ${name} åˆ°è´­ç‰©è½¦`);
                  }
                };

                window.removeItem = function removeItem(btn) {
                  const itemName = btn.closest('.cart-item').querySelector('.item-name').textContent;
                  btn.closest('.cart-item').remove();
                  updateCartCount();

                  // Announce to screen reader
                  if (window.announceToScreenReader) {
                    window.announceToScreenReader(`å·²ä»è´­ç‰©è½¦ç§»é™¤ ${itemName}`);
                  }
                };

                window.clearCart = function clearCart() {
                  const count = document.querySelectorAll('.cart-item').length;
                  document.getElementById('cartItems').innerHTML = '';
                  updateCartCount();

                  // Announce to screen reader
                  if (window.announceToScreenReader) {
                    window.announceToScreenReader(`å·²æ¸…ç©ºè´­ç‰©è½¦ï¼Œç§»é™¤äº† ${count} ä»¶å•†å“`);
                  }
                };

                function updateCartCount() {
                  const count = document.querySelectorAll('.cart-item').length;
                  const countElement = document.getElementById('cartCount');
                  countElement.textContent = `${count} ä»¶å•†å“`;

                  // Update aria-label for better screen reader support
                  countElement.setAttribute('aria-label', `è´­ç‰©è½¦ä¸­æœ‰ ${count} ä»¶å•†å“`);
                }
              </script>

              <p style="margin-top: 20px; color: var(--text-secondary); font-size: 0.9rem">
                ğŸ’¡ æ·»åŠ å•†å“åˆ°è´­ç‰©è½¦ï¼Œè§‚å¯Ÿç©ºçŠ¶æ€å’Œæœ‰å•†å“çŠ¶æ€çš„åˆ‡æ¢ã€‚ç»“ç®—æŒ‰é’®åªåœ¨æœ‰å•†å“æ—¶æ˜¾ç¤ºã€‚
              </p>
            </div>

            <div class="demo-code">
              <pre><code><span class="code-comment">/* è´­ç‰©è½¦ä¸ºç©ºæ—¶æ˜¾ç¤ºæç¤º */</span>
.shopping-cart:not(:has(.cart-item)) .empty-message {
  display: block;
}

<span class="code-comment">/* éšè—ç©ºè´­ç‰©è½¦çš„å•†å“åˆ—è¡¨ */</span>
.shopping-cart:not(:has(.cart-item)) .cart-items {
  display: none;
}

<span class="code-comment">/* éšè—ç©ºè´­ç‰©è½¦çš„æ•°é‡æ ‡ç­¾ */</span>
.shopping-cart:not(:has(.cart-item)) .cart-count {
  display: none;
}

<span class="code-comment">/* è´­ç‰©è½¦æœ‰å•†å“æ—¶æ˜¾ç¤ºç»“ç®—æŒ‰é’® */</span>
.shopping-cart:has(.cart-item) .cart-actions {
  display: flex;
}

<span class="code-comment">/* ä¼˜åŠ¿ï¼šæ ¹æ®å•†å“æ•°é‡è‡ªåŠ¨åˆ‡æ¢çŠ¶æ€ï¼Œæ— éœ€æ‰‹åŠ¨ç®¡ç†ç±»å */</span></code></pre>
            </div>
          </div>
        </section>

        <!-- æµè§ˆå™¨å…¼å®¹æ€§ -->
        <section class="compatibility-section">
          <h2>æµè§ˆå™¨å…¼å®¹æ€§</h2>
          <p style="color: var(--text-secondary); margin-bottom: 20px">
            <code>:has()</code> æ˜¯ä¸€ä¸ªç›¸å¯¹è¾ƒæ–°çš„ CSS ç‰¹æ€§ï¼Œä¸»æµç°ä»£æµè§ˆå™¨å·²ç»æ”¯æŒã€‚
          </p>

          <table class="compatibility-table">
            <thead>
              <tr>
                <th>æµè§ˆå™¨</th>
                <th>ç‰ˆæœ¬</th>
                <th>æ”¯æŒçŠ¶æ€</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Chrome / Edge</td>
                <td>105+</td>
                <td class="support-yes">âœ“ å®Œå…¨æ”¯æŒ</td>
              </tr>
              <tr>
                <td>Firefox</td>
                <td>121+</td>
                <td class="support-yes">âœ“ å®Œå…¨æ”¯æŒ</td>
              </tr>
              <tr>
                <td>Safari</td>
                <td>15.4+</td>
                <td class="support-yes">âœ“ å®Œå…¨æ”¯æŒ</td>
              </tr>
              <tr>
                <td>Opera</td>
                <td>91+</td>
                <td class="support-yes">âœ“ å®Œå…¨æ”¯æŒ</td>
              </tr>
              <tr>
                <td>IE 11</td>
                <td>-</td>
                <td class="support-no">âœ— ä¸æ”¯æŒ</td>
              </tr>
            </tbody>
          </table>

          <div
            style="
              background: var(--warning-light);
              border-left: 4px solid var(--warning);
              padding: 15px;
              border-radius: var(--radius-md);
              margin-top: 20px;
            "
          >
            <strong style="color: var(--warning-dark)">âš ï¸ å…¼å®¹æ€§å»ºè®®</strong>
            <p style="color: var(--text-primary); margin-top: 8px; line-height: 1.6">
              å¦‚æœéœ€è¦æ”¯æŒæ—§ç‰ˆæµè§ˆå™¨ï¼Œå¯ä»¥ä½¿ç”¨ <code>@supports</code> æ£€æµ‹ <code>:has()</code> æ”¯æŒæƒ…å†µï¼Œ
              å¹¶æä¾›é™çº§æ–¹æ¡ˆï¼ˆå¦‚ä½¿ç”¨ JavaScript æˆ–ä¼ ç»Ÿçš„ç±»åç®¡ç†ï¼‰ã€‚
            </p>
            <pre
              style="margin-top: 10px; background: var(--bg-primary); padding: 10px; border-radius: 4px"
            ><code><span class="code-comment">/* æ£€æµ‹ :has() æ”¯æŒ */</span>
@supports selector(:has(*)) {
  .card:has(input:checked) {
    /* æ”¯æŒ :has() çš„æ ·å¼ */
  }
}

@supports not selector(:has(*)) {
  .card.selected {
    /* é™çº§æ–¹æ¡ˆï¼šä½¿ç”¨ç±»å */
  }
}</code></pre>
          </div>

          <p style="margin-top: 20px; color: var(--text-secondary)">
            æ›´å¤šå…¼å®¹æ€§ä¿¡æ¯è¯·è®¿é—®ï¼š
            <a href="https://caniuse.com/css-has" target="_blank" style="color: var(--primary); font-weight: 600">
              Can I Use - :has()
            </a>
          </p>
        </section>

        <!-- æ€»ç»“ -->
        <section class="concept-section" style="margin-top: 50px">
          <h2>å®æˆ˜æ€»ç»“</h2>
          <p>é€šè¿‡è¿™ 4 ä¸ªå®æˆ˜æ¡ˆä¾‹ï¼Œæˆ‘ä»¬çœ‹åˆ°äº† <code>:has()</code> åœ¨çœŸå®é¡¹ç›®ä¸­çš„å¼ºå¤§åº”ç”¨ï¼š</p>
          <ul>
            <li><strong>è¡¨å•éªŒè¯</strong> - æ— éœ€ JavaScript å³å¯å®ç°å®æ—¶éªŒè¯åé¦ˆ</li>
            <li><strong>å¡ç‰‡ç®¡ç†</strong> - æ ¹æ®å†…å®¹å’ŒçŠ¶æ€è‡ªåŠ¨è°ƒæ•´æ ·å¼å’Œå¸ƒå±€</li>
            <li><strong>æ™ºèƒ½å¯¼èˆª</strong> - çˆ¶çº§èœå•è‡ªåŠ¨æ„ŸçŸ¥å­é“¾æ¥çŠ¶æ€</li>
            <li><strong>è´­ç‰©è½¦</strong> - æ ¹æ®å•†å“æ•°é‡åŠ¨æ€åˆ‡æ¢ç©º/éç©ºçŠ¶æ€</li>
          </ul>
          <p>
            <code>:has()</code> è®©æˆ‘ä»¬èƒ½å¤Ÿç”¨çº¯ CSS å®ç°è®¸å¤šä»¥å‰éœ€è¦ JavaScript æ‰èƒ½å®Œæˆçš„åŠŸèƒ½ï¼Œ
            å¤§å¤§ç®€åŒ–äº†ä»£ç ï¼Œæå‡äº†æ€§èƒ½å’Œå¯ç»´æŠ¤æ€§ã€‚åœ¨æ”¯æŒçš„æµè§ˆå™¨ä¸­ï¼Œå®ƒæ˜¯ä¸€ä¸ªéå¸¸å€¼å¾—ä½¿ç”¨çš„ç°ä»£ç‰¹æ€§ã€‚
          </p>
        </section>
      </div>
    </main>
  </body>
</html>
