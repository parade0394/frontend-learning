<!doctype html>
<html data-theme="light" lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@keyframes - CSS 动画教程</title>
    <link href="../styles.css" rel="stylesheet" />
    <script type="module" src="/src/theme-sync.js"></script>
    <style>
      /* 示例动画定义 */
      @keyframes slideIn {
        from {
          transform: translateX(-100%);
          opacity: 0;
        }
        to {
          transform: translateX(0);
          opacity: 1;
        }
      }

      @keyframes bounce {
        0%,
        100% {
          transform: translateY(0);
        }
        50% {
          transform: translateY(-30px);
        }
      }

      @keyframes colorChange {
        0% {
          background: #10b981;
        }
        33% {
          background: #3b82f6;
        }
        66% {
          background: #8b5cf6;
        }
        100% {
          background: #10b981;
        }
      }

      @keyframes rotate3d {
        from {
          transform: rotate3d(0, 1, 0, 0deg);
        }
        to {
          transform: rotate3d(0, 1, 0, 360deg);
        }
      }

      /* direction 演示动画 */
      @keyframes moveRight {
        from {
          transform: translateX(0);
        }
        to {
          transform: translateX(100px);
        }
      }

      .animate-slide {
        animation: slideIn 1s ease-out;
      }
      .animate-bounce {
        animation: bounce 1s ease-in-out infinite;
      }
      .animate-color {
        animation: colorChange 3s ease-in-out infinite;
      }
      .animate-rotate3d {
        animation: rotate3d 3s linear infinite;
      }
    </style>
  </head>
  <body>
    <!-- 左侧边栏导航 -->
    <!-- 左侧边栏导航 -->
    <aside class="sidebar">
      <div class="sidebar-header">
        <h1>CSS Transform & Transition</h1>
        <a class="back-home" href="../index.html">← 返回主页</a>
      </div>
      <nav class="sidebar-nav">
        <!-- 基础概念 -->
        <div class="nav-section">
          <h3>基础概念</h3>
          <a class="nav-item" href="overview.html">CSS 动画总览</a>
          <a class="nav-item" href="coordinate.html">坐标系统</a>
        </div>

        <!-- Transform 变换 -->
        <div class="nav-section">
          <h3>Transform 变换</h3>
          <a class="nav-item" href="translate.html">translate()</a>
          <a class="nav-item" href="translateX.html">translateX()</a>
          <a class="nav-item" href="translateY.html">translateY()</a>
          <a class="nav-item" href="translateZ.html">translateZ()</a>
          <a class="nav-item" href="rotate.html">rotate()</a>
          <a class="nav-item" href="rotateX.html">rotateX()</a>
          <a class="nav-item" href="rotateY.html">rotateY()</a>
          <a class="nav-item" href="rotateZ.html">rotateZ()</a>
          <a class="nav-item" href="scale.html">scale()</a>
          <a class="nav-item" href="scaleX.html">scaleX()</a>
          <a class="nav-item" href="scaleY.html">scaleY()</a>
          <a class="nav-item" href="scaleZ.html">scaleZ()</a>
          <a class="nav-item" href="skew.html">skew()</a>
          <a class="nav-item" href="skewX.html">skewX()</a>
          <a class="nav-item" href="skewY.html">skewY()</a>
          <a class="nav-item" href="multiple.html">组合变换</a>
        </div>

        <!-- Transition 过渡 -->
        <div class="nav-section">
          <h3>Transition 过渡</h3>
          <a class="nav-item" href="duration.html">transition-duration</a>
          <a class="nav-item" href="timing.html">transition-timing-function</a>
          <a class="nav-item" href="delay.html">transition-delay</a>
        </div>

        <!-- Animation 动画 -->
        <div class="nav-section">
          <h3>Animation 动画</h3>
          <a class="nav-item active" href="keyframes.html">@keyframes</a>
          <a class="nav-item" href="animation-play-state.html">animation-play-state</a>
          <a class="nav-item" href="fill-mode-demo.html">animation-fill-mode</a>
        </div>

        <!-- 3D 变换 -->
        <div class="nav-section">
          <h3>3D 变换</h3>
          <a class="nav-item" href="perspective.html">perspective</a>
          <a class="nav-item" href="rotate3d.html">rotate3d()</a>
          <a class="nav-item" href="translate3d.html">translate3d()</a>
          <a class="nav-item" href="transform-style.html">transform-style</a>
          <a class="nav-item" href="backface-visibility.html">backface-visibility</a>
          <a class="nav-item" href="perspective-origin.html">perspective-origin</a>
        </div>

        <!-- 高级属性 -->
        <div class="nav-section">
          <h3>高级属性</h3>
          <a class="nav-item" href="transform-origin.html">transform-origin</a>
          <a class="nav-item" href="will-change.html">will-change</a>
        </div>
      </nav>
    </aside>

    <main class="main-content">
      <div class="demo-page">
        <h1>@keyframes - 关键帧动画</h1>
        <p class="subtitle">创建复杂的、可重复的动画效果</p>

        <section class="section">
          <h2>什么是 @keyframes？</h2>
          <p>
            @keyframes 用于定义动画的关键帧，可以创建比 transition
            更复杂的动画效果。它允许你精确控制动画在不同时间点的状态。
          </p>

          <ul>
            <li><strong>关键帧：</strong>定义动画在特定时间点的样式</li>
            <li><strong>可重复：</strong>动画可以循环播放</li>
            <li><strong>更灵活：</strong>可以定义多个中间状态</li>
            <li><strong>自动播放：</strong>页面加载时自动开始</li>
          </ul>
        </section>

        <section class="section">
          <h2>基本语法</h2>
          <pre class="code-block"><code><span class="comment">/* 方式 1：使用 from 和 to */</span>
<span class="keyword">@keyframes</span> <span class="value">animationName</span> {
  <span class="keyword">from</span> { <span class="property">transform</span>: <span class="value">translateX(0)</span>; }
  <span class="keyword">to</span> { <span class="property">transform</span>: <span class="value">translateX(100px)</span>; }
}

<span class="comment">/* 方式 2：使用百分比 */</span>
<span class="keyword">@keyframes</span> <span class="value">animationName</span> {
  <span class="keyword">0%</span> { <span class="property">transform</span>: <span class="value">translateX(0)</span>; }
  <span class="keyword">50%</span> { <span class="property">transform</span>: <span class="value">translateX(100px)</span>; }
  <span class="keyword">100%</span> { <span class="property">transform</span>: <span class="value">translateX(0)</span>; }
}

<span class="comment">/* 应用动画 */</span>
<span class="keyword">.element</span> {
  <span class="property">animation</span>: <span class="value">animationName 2s ease-in-out infinite</span>;
}</code></pre>
        </section>

        <section class="section">
          <h2>from/to vs 百分比</h2>

          <h3 style="font-size: 1.2rem; margin: 20px 0 10px 0; color: #059669">使用 from 和 to</h3>
          <ul>
            <li><span class="highlight">from</span> - 等同于 <span class="highlight">0%</span>，表示动画的起始状态</li>
            <li><span class="highlight">to</span> - 等同于 <span class="highlight">100%</span>，表示动画的结束状态</li>
            <li><strong>适用场景：</strong>简单的两个状态之间的过渡</li>
            <li><strong>优点：</strong>语义清晰，代码简洁</li>
          </ul>

          <pre class="code-block"><code><span class="keyword">@keyframes</span> <span class="value">fadeIn</span> {
  <span class="keyword">from</span> { <span class="property">opacity</span>: <span class="value">0</span>; }
  <span class="keyword">to</span> { <span class="property">opacity</span>: <span class="value">1</span>; }
}</code></pre>

          <h3 style="font-size: 1.2rem; margin: 20px 0 10px 0; color: #059669">使用百分比</h3>
          <ul>
            <li><span class="highlight">0%</span> - 动画开始时的状态</li>
            <li><span class="highlight">50%</span> - 动画进行到一半时的状态</li>
            <li><span class="highlight">100%</span> - 动画结束时的状态</li>
            <li><strong>适用场景：</strong>需要多个中间状态的复杂动画</li>
            <li><strong>优点：</strong>可以精确控制动画的每个阶段</li>
          </ul>

          <pre class="code-block"><code><span class="keyword">@keyframes</span> <span class="value">complexMove</span> {
  <span class="keyword">0%</span> { <span class="property">transform</span>: <span class="value">translateX(0)</span>; }
  <span class="keyword">25%</span> { <span class="property">transform</span>: <span class="value">translateX(100px)</span>; }
  <span class="keyword">50%</span> { <span class="property">transform</span>: <span class="value">translateX(100px) translateY(50px)</span>; }
  <span class="keyword">75%</span> { <span class="property">transform</span>: <span class="value">translateX(0) translateY(50px)</span>; }
  <span class="keyword">100%</span> { <span class="property">transform</span>: <span class="value">translateX(0) translateY(0)</span>; }
}</code></pre>

          <div class="info-box">
            <p>
              <strong>选择建议：</strong>如果只有开始和结束两个状态，使用 from/to
              更简洁；如果需要多个中间状态，使用百分比更灵活
            </p>
          </div>
        </section>

        <section class="section">
          <h2>示例对比：from/to vs 百分比</h2>
          <p>下面两个动画效果完全相同，只是写法不同</p>

          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px">
            <div>
              <p style="text-align: center; margin-bottom: 10px">
                <strong>使用 from/to</strong>
              </p>
              <pre
                class="code-block"
                style="font-size: 0.85rem"
              ><code><span class="keyword">@keyframes</span> <span class="value">simple</span> {
  <span class="keyword">from</span> { <span class="property">opacity</span>: <span class="value">0</span>; }
  <span class="keyword">to</span> { <span class="property">opacity</span>: <span class="value">1</span>; }
}</code></pre>
            </div>
            <div>
              <p style="text-align: center; margin-bottom: 10px">
                <strong>使用百分比</strong>
              </p>
              <pre
                class="code-block"
                style="font-size: 0.85rem"
              ><code><span class="keyword">@keyframes</span> <span class="value">simple</span> {
  <span class="keyword">0%</span> { <span class="property">opacity</span>: <span class="value">0</span>; }
  <span class="keyword">100%</span> { <span class="property">opacity</span>: <span class="value">1</span>; }
}</code></pre>
            </div>
          </div>

          <div class="info-box">
            <p><strong>等价关系：</strong>from = 0%，to = 100%。两种写法完全等价，选择你喜欢的即可</p>
          </div>
        </section>

        <section class="section">
          <h2>示例 1：滑入动画（使用 from/to）</h2>
          <p>元素从左侧滑入并淡入</p>

          <div class="demo-area">
            <div id="demo-box-1" class="box">滑入</div>
          </div>

          <button class="play-button" data-demo="demo1">播放动画</button>

          <pre class="code-block"><code><span class="keyword">@keyframes</span> <span class="value">slideIn</span> {
  <span class="keyword">from</span> {
    <span class="property">transform</span>: <span class="value">translateX(-100%)</span>;
    <span class="property">opacity</span>: <span class="value">0</span>;
  }
  <span class="keyword">to</span> {
    <span class="property">transform</span>: <span class="value">translateX(0)</span>;
    <span class="property">opacity</span>: <span class="value">1</span>;
  }
}

<span class="keyword">.box</span> {
  <span class="property">animation</span>: <span class="value">slideIn 1s ease-out</span>;
}</code></pre>
        </section>

        <section class="section">
          <h2>示例 2：弹跳动画</h2>
          <p>元素持续上下弹跳</p>

          <div class="demo-area">
            <div id="demo-box-2" class="box">弹跳</div>
          </div>

          <button class="play-button" data-demo="demo2">播放动画</button>

          <pre class="code-block"><code><span class="keyword">@keyframes</span> <span class="value">bounce</span> {
  <span class="keyword">0%, 100%</span> {
    <span class="property">transform</span>: <span class="value">translateY(0)</span>;
  }
  <span class="keyword">50%</span> {
    <span class="property">transform</span>: <span class="value">translateY(-30px)</span>;
  }
}

<span class="keyword">.box</span> {
  <span class="property">animation</span>: <span class="value">bounce 1s ease-in-out infinite</span>;
  <span class="comment">/* infinite 表示无限循环 */</span>
}</code></pre>
        </section>

        <section class="section">
          <h2>示例 3：颜色变化</h2>
          <p>背景色在多个颜色之间循环变化</p>

          <div class="demo-area">
            <div id="demo-box-3" class="box">颜色</div>
          </div>

          <button class="play-button" data-demo="demo3">播放动画</button>

          <pre class="code-block"><code><span class="keyword">@keyframes</span> <span class="value">colorChange</span> {
  <span class="keyword">0%</span> { <span class="property">background</span>: <span class="value">#10b981</span>; }
  <span class="keyword">33%</span> { <span class="property">background</span>: <span class="value">#3b82f6</span>; }
  <span class="keyword">66%</span> { <span class="property">background</span>: <span class="value">#8b5cf6</span>; }
  <span class="keyword">100%</span> { <span class="property">background</span>: <span class="value">#10b981</span>; }
}

<span class="keyword">.box</span> {
  <span class="property">animation</span>: <span class="value">colorChange 3s ease-in-out infinite</span>;
}</code></pre>
        </section>

        <section class="section">
          <h2>示例 4：3D 旋转</h2>
          <p>元素在 3D 空间中持续旋转</p>

          <div class="demo-area perspective">
            <div id="demo-box-4" class="box">3D</div>
          </div>

          <button class="play-button" data-demo="demo4">播放动画</button>

          <pre class="code-block"><code><span class="keyword">@keyframes</span> <span class="value">rotate3d</span> {
  <span class="keyword">from</span> {
    <span class="property">transform</span>: <span class="value">rotate3d(0, 1, 0, 0deg)</span>;
  }
  <span class="keyword">to</span> {
    <span class="property">transform</span>: <span class="value">rotate3d(0, 1, 0, 360deg)</span>;
  }
}

<span class="keyword">.box</span> {
  <span class="property">animation</span>: <span class="value">rotate3d 3s linear infinite</span>;
}</code></pre>
        </section>

        <section class="section">
          <h2>animation 属性详解</h2>
          <pre class="code-block"><code><span class="keyword">.element</span> {
  <span class="property">animation</span>: <span class="value">name duration timing-function delay iteration-count direction fill-mode</span>;
}</code></pre>

          <ul>
            <li><span class="highlight">animation-name</span> - 动画名称（@keyframes 定义的名称）</li>
            <li>
              <span class="highlight">animation-duration</span> - 持续时间（如 2s, 500ms）<strong
                >决定动画何时结束</strong
              >
            </li>
            <li><span class="highlight">animation-timing-function</span> - 缓动函数（ease, linear, ease-in-out 等）</li>
            <li><span class="highlight">animation-delay</span> - 延迟时间（如 1s）</li>
            <li><span class="highlight">animation-iteration-count</span> - 播放次数（数字或 infinite）</li>
            <li><span class="highlight">animation-direction</span> - 播放方向（见下方详解）</li>
            <li><span class="highlight">animation-fill-mode</span> - 填充模式（见下方详解）</li>
          </ul>

          <div class="info-box">
            <p>
              <strong>重要：</strong>动画从 0% 到 100% 的时间由 animation-duration 决定。例如 duration: 2s 表示动画会在
              2 秒内完成从 0% 到 100% 的所有关键帧
            </p>
          </div>
        </section>

        <section class="section">
          <h2>animation-direction 详解</h2>
          <p>控制动画的播放方向</p>

          <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin: 20px 0">
            <div>
              <h3 style="font-size: 1.1rem; margin-bottom: 10px">normal（默认）</h3>
              <div class="demo-area" style="min-height: 150px">
                <div id="direction-normal" class="box" style="animation: none">→</div>
              </div>
              <button class="play-button" data-demo="direction" data-param="normal" style="width: 100%">播放</button>
              <p style="margin-top: 10px; color: #6b7280; font-size: 0.9rem">正常播放：0% → 100%</p>
            </div>

            <div>
              <h3 style="font-size: 1.1rem; margin-bottom: 10px">reverse</h3>
              <div class="demo-area" style="min-height: 150px">
                <div id="direction-reverse" class="box" style="animation: none">←</div>
              </div>
              <button class="play-button" data-demo="direction" data-param="reverse" style="width: 100%">播放</button>
              <p style="margin-top: 10px; color: #6b7280; font-size: 0.9rem">反向播放：100% → 0%</p>
            </div>

            <div>
              <h3 style="font-size: 1.1rem; margin-bottom: 10px">alternate</h3>
              <div class="demo-area" style="min-height: 150px">
                <div id="direction-alternate" class="box" style="animation: none">⇄</div>
              </div>
              <button class="play-button" data-demo="direction" data-param="alternate" style="width: 100%">播放</button>
              <p style="margin-top: 10px; color: #6b7280; font-size: 0.9rem">交替播放：正向 → 反向 → 正向...</p>
            </div>

            <div>
              <h3 style="font-size: 1.1rem; margin-bottom: 10px">alternate-reverse</h3>
              <div class="demo-area" style="min-height: 150px">
                <div id="direction-alternate-reverse" class="box" style="animation: none">⇄</div>
              </div>
              <button class="play-button" data-demo="direction" data-param="alternate-reverse" style="width: 100%">
                播放
              </button>
              <p style="margin-top: 10px; color: #6b7280; font-size: 0.9rem">反向交替：反向 → 正向 → 反向...</p>
            </div>
          </div>

          <pre class="code-block"><code><span class="keyword">.normal</span> {
  <span class="property">animation-direction</span>: <span class="value">normal</span>;
}
<span class="keyword">.reverse</span> {
  <span class="property">animation-direction</span>: <span class="value">reverse</span>;
}
<span class="keyword">.alternate</span> {
  <span class="property">animation-direction</span>: <span class="value">alternate</span>;
}
<span class="keyword">.alternate-reverse</span> {
  <span class="property">animation-direction</span>: <span class="value">alternate-reverse</span>;
}</code></pre>
        </section>

        <section class="section">
          <h2>animation-fill-mode 简介</h2>
          <p>控制动画开始前和结束后元素的状态</p>

          <ul>
            <li><span class="highlight">none</span> - 默认值，延迟期间和结束后都不应用动画样式</li>
            <li><span class="highlight">forwards</span> - 动画结束后保持最后一帧的状态（最常用！）</li>
            <li><span class="highlight">backwards</span> - 延迟期间应用第一帧样式</li>
            <li><span class="highlight">both</span> - 结合 backwards 和 forwards 的效果</li>
          </ul>

          <div class="info-box" style="background: #ecfdf5; border-left-color: #10b981; margin-top: 20px">
            <h3 style="color: #059669">🎯 想深入理解 fill-mode？</h3>
            <p style="color: #065f46">
              <a
                href="fill-mode-demo.html"
                style="color: #10b981; font-weight: 600; text-decoration: none; border-bottom: 2px solid #10b981"
              >
                👉 点击查看 animation-fill-mode 详细演示页面
              </a>
              <br />
              <span style="font-size: 0.9rem; margin-top: 5px; display: inline-block">
                包含更直观的对比演示、完整代码示例和最佳实践建议
              </span>
            </p>
          </div>

          <pre class="code-block"><code><span class="comment">/* 基本用法 */</span>
<span class="keyword">.element</span> {
  <span class="property">animation-fill-mode</span>: <span class="value">forwards</span>; <span class="comment">/* 保持最后一帧 */</span>
}

<span class="comment">/* 简写形式 */</span>
<span class="keyword">.element</span> {
  <span class="property">animation</span>: <span class="value">myAnimation 2s ease-out forwards</span>;
}</code></pre>
        </section>

        <section class="section">
          <h2>常见应用场景</h2>
          <div class="scenario-links">
            <a class="scenario-link" href="../practical-demos/loading-spinner.html">
              <span class="scenario-icon">⏳</span>
              <div class="scenario-content">
                <h4>加载动画</h4>
                <p>查看完整实现 →</p>
              </div>
            </a>
          </div>
        </section>
      </div>
    </main>

    <script type="module">
      import { playAnimation } from '/src/utils.js';

      // 使用事件委托，避免全局命名冲突
      const demos = {
        demo1: () => {
          const box = document.getElementById('demo-box-1');
          // slideIn 动画持续 1 秒
          playAnimation(box, 'animate-slide', 1000);
        },
        demo2: () => {
          const box = document.getElementById('demo-box-2');
          // bounce 是无限循环，手动控制
          box.classList.remove('animate-bounce');
          void box.offsetHeight;
          box.classList.add('animate-bounce');
          // 3 秒后停止
          setTimeout(() => {
            box.classList.remove('animate-bounce');
          }, 3000);
        },
        demo3: () => {
          const box = document.getElementById('demo-box-3');
          // colorChange 是无限循环，手动控制
          box.classList.remove('animate-color');
          void box.offsetHeight;
          box.classList.add('animate-color');
          // 6 秒后停止（2 个完整循环）
          setTimeout(() => {
            box.classList.remove('animate-color');
          }, 6000);
        },
        demo4: () => {
          const box = document.getElementById('demo-box-4');
          // rotate3d 是无限循环，手动控制
          box.classList.remove('animate-rotate3d');
          void box.offsetHeight;
          box.classList.add('animate-rotate3d');
          // 6 秒后停止（2 个完整循环）
          setTimeout(() => {
            box.classList.remove('animate-rotate3d');
          }, 6000);
        },
        direction: (param) => {
          const box = document.getElementById('direction-' + param);
          if (!box) {
            return;
          }

          // 重置
          box.style.animation = 'none';
          box.offsetHeight;

          // 应用动画
          setTimeout(() => {
            box.style.animation = `moveRight 1s ease-in-out 0s 3 ${param}`;
          }, 10);

          // 3 次循环后重置
          setTimeout(() => {
            box.style.animation = 'none';
          }, 3100);
        },
      };

      // 事件委托：监听所有点击
      document.addEventListener('click', (e) => {
        const button = e.target.closest('[data-demo]');
        if (button) {
          const demoName = button.dataset.demo;
          const param = button.dataset.param;
          if (demos[demoName]) {
            demos[demoName](param);
          }
        }
      });
    </script>
  </body>
</html>
